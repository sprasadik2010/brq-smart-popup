import{useState as e,useRef as t,useEffect as n}from"react";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,u=[],l=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(u.push(r.value),u.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(e,t)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(r){var i=r.api,a=r.dataKey,u=r.displayFields,l=void 0===u?[]:u,c=r.bindFields,d=void 0===c?{}:c,f=o(e([]),2),s=f[0],v=f[1],m=o(e(!1),2),p=m[0],y=m[1],h=o(e(0),2),b=h[0],g=h[1],w=o(e({top:0,left:0,width:0}),2),E=w[0],x=w[1],L=o(e(""),2),k=L[0],A=L[1],j=o(e(""),2),I=j[0],N=j[1],R=t(null);n((function(){fetch(i).then((function(e){return e.json()})).then((function(e){return v(e[a]||[])})).catch(console.error)}),[i,a]),n((function(){var e=[],t=function(e){p&&("ArrowDown"===e.key?(e.preventDefault(),g((function(e){return(e+1)%O.length}))):"ArrowUp"===e.key?(e.preventDefault(),g((function(e){return(e-1+O.length)%O.length}))):"Enter"===e.key?(e.preventDefault(),C(O[b])):"Escape"===e.key&&y(!1))};Object.entries(d).forEach((function(n){var r=o(n,2),i=r[0],a=r[1],u=document.getElementById(a);if(u){var l=function(){var e=u.getBoundingClientRect();x({top:e.bottom+window.scrollY,left:e.left+window.scrollX,width:e.width}),N(i),A(u.value||""),y(!0)},c=function(e){A(e.target.value)};u.addEventListener("focus",l),u.addEventListener("keydown",t),u.addEventListener("input",c),e.push((function(){u.removeEventListener("focus",l),u.removeEventListener("keydown",t),u.removeEventListener("input",c)}))}}));var n=function(e){var t;null!==(t=R.current)&&void 0!==t&&t.contains(e.target)||y(!1)};return document.addEventListener("mousedown",n),function(){e.forEach((function(e){return e()})),document.removeEventListener("mousedown",n)}}),[s,d,p]);var S=function(e,t){return t.split(".").reduce((function(e,t){return null==e?void 0:e[t]}),e)},C=function(e){Object.entries(d).forEach((function(t){var n=o(t,2),r=n[0],i=n[1],a=document.getElementById(i),u=S(e,r);a&&void 0!==u&&(a.value=u,a.dispatchEvent(new Event("input",{bubbles:!0})))})),y(!1)},O=s.filter((function(e){var t=S(e,I);return null==t?void 0:t.toString().toLowerCase().includes(k.toLowerCase())}));return p?React.createElement("div",{ref:R,style:{position:"fixed",top:E.top+4,left:E.left,width:E.width,zIndex:9999},className:"max-h-80 overflow-y-auto space-y-2 p-2 bg-white border border-gray-200 shadow rounded-xl"},0===O.length&&React.createElement("div",{className:"p-2 text-gray-500 text-sm"},"No matches found."),O.map((function(e,t){return React.createElement("div",{key:t,onClick:function(){return C(e)},className:"rounded-xl p-4 shadow cursor-pointer border transition ".concat(b===t?"bg-blue-100 border-blue-400":"bg-white hover:bg-gray-50 border-gray-200")},l.map((function(t,n){return React.createElement("div",{key:n,className:"text-sm text-gray-700"},React.createElement("span",{className:"font-semibold text-gray-800"},t.split(".").pop(),":")," ",S(e,t))})))}))):null}export{i as BRQSmartPopup};
//# sourceMappingURL=index.esm.js.map
